<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Gordon的寇汀筆記本</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Gordon的寇汀筆記本"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Gordon的寇汀筆記本"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="紀錄個人軟體開發筆記本"><meta property="og:type" content="blog"><meta property="og:title" content="Gordon的寇汀筆記本"><meta property="og:url" content="https://gordonfang199649.github.io/"><meta property="og:site_name" content="Gordon的寇汀筆記本"><meta property="og:description" content="紀錄個人軟體開發筆記本"><meta property="og:locale" content="zh_TW"><meta property="og:image" content="https://gordonfang199649.github.io/img/og_image.png"><meta property="article:author" content="Gordon Fang"><meta property="article:tag" content="Software Engineering"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://gordonfang199649.github.io"},"headline":"Gordon的寇汀筆記本","image":["https://gordonfang199649.github.io/img/og_image.png"],"author":{"@type":"Person","name":"Gordon Fang"},"publisher":{"@type":"Organization","name":"Gordon Fang","logo":{"@type":"ImageObject","url":"https://gordonfang199649.github.io/img/logo.svg"}},"description":"紀錄個人軟體開發筆記本"}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Gordon的寇汀筆記本" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item is-active" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item is-active" href="/">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜尋" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-image"><a class="image is-7by3" href="/2022/03/31/Azure-DevOps-Stakeholder-%E6%AC%8A%E9%99%90%E7%9C%8B%E4%B8%8D%E5%88%B0-Repo/"><img class="fill" src="https://images.unsplash.com/photo-1508971344143-29b17efc1689?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=1074&amp;q=80" alt="Azure DevOps Stakeholder 權限看不到 Repo"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-03-30T16:35:12.000Z" title="3/31/2022, 12:35:12 AM">2022-03-31</time>發表</span><span class="level-item"><time dateTime="2022-03-30T17:23:10.508Z" title="3/31/2022, 1:23:10 AM">2022-03-31</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Azure-DevOps/">Azure DevOps</a></span><span class="level-item">3 分鐘讀完 (大約457個字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/31/Azure-DevOps-Stakeholder-%E6%AC%8A%E9%99%90%E7%9C%8B%E4%B8%8D%E5%88%B0-Repo/">Azure DevOps Stakeholder 權限看不到 Repo</a></h1><div class="content"><h2 id="問題描述"><a href="#問題描述" class="headerlink" title="問題描述"></a>問題描述</h2><p>我們使用 CI/CD 平台是 Azure DevOps，我們預計想做 Side project，想把技術支援連結放在 Wiki，朋友說他有將我們每一個人權限設置為 Admin，另外也有用 git 控管 Wiki，而我遇到的問題是無法在平台的 side menu 找到 Repo 圖示，於是我跳出來組織的畫面，從 Project 的 Repo 圖示點，但卻看到 403 無權限存取。</p>
<p><img src="https://i.imgur.com/7SJKzKZ.png" alt="Image"></p>
<p><img src="https://i.imgur.com/MaSU34u.png" alt="Image"></p>
<h2 id="解決辦法"><a href="#解決辦法" class="headerlink" title="解決辦法"></a>解決辦法</h2><p>後來我才發現原來即便專案的權限開到最大，成員仍無法存取某些功能。</p>
<ol>
<li>建立專案後，邀請其他人加入某一專案內，此人若沒有在這個組織內，系統會將其權限設定為 Stakeholder 的角色。</li>
<li>Stakeholder 的角色是沒有版本控制的功能可以使用，換句話說開發人員角色必須是 Basic 或 Visual Studio Subscriber。</li>
<li>第二點合理的原因是因為利害關係人不應該觸碰版本控制的東西，他的職責所在在於「驗收產品」。</li>
</ol>
<h3 id="操作設定"><a href="#操作設定" class="headerlink" title="操作設定"></a>操作設定</h3><p>首先，從專案頁面跳回去組織頁面，找到 side menu 的 Organization settings</p>
<p><img src="https://i.imgur.com/a52gqWE.png" alt="Image"></p>
<p>從 Organization settings 找到 Users，可以發現邀請的組員都會在裡面</p>
<p><img src="https://i.imgur.com/6HcmpTe.png" alt="Image"></p>
<p>接著對應該是開發人員的組員 Access Level 調整成 Basic 或 Visual Studio Subscriber。</p>
<p><img src="https://i.imgur.com/S6urj3w.png" alt="Image"></p>
<p>最後調整完，那我們就可以看到 Repo 的功能了 :D</p>
<h2 id="參考資源"><a href="#參考資源" class="headerlink" title="參考資源"></a>參考資源</h2><p><a target="_blank" rel="noopener" href="https://jd-bots.com/2021/08/22/fixed-cannot-see-repos-in-azure-devops-with-stakeholder-access/">[Fixed] Cannot see Repos in Azure DevOps with Stakeholder Access</a></p>
<p><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10264090">【把玩Azure DevOps】Day3 Organization與Projects</a></p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2022/03/12/%E5%A6%82%E4%BD%95%E5%9C%A8-Hexo-%E9%96%8B%E7%99%BC%E7%92%B0%E5%A2%83%E7%9A%84%E6%96%87%E7%AB%A0%E4%B8%AD%E5%8A%A0%E5%85%A5-LikeCoin-button/"><img class="fill" src="https://8565014-files.gitbook.io/~/files/v0/b/gitbook-28427.appspot.com/o/assets%2F-LL4mdaVjNgL6A1--PV0%2F-M-JYlmUCo6udh9A6gxn%2F-M-J_xspSsjzpvobwIQG%2FLikeCoin_presskit_LikeCoin_Asset_LikeCoinFeature.png?alt=media&amp;token=0b819621-3d86-4043-ba21-7770b74ce2e3" alt="[Hexo] 如何在 Hexo 開發環境的文章中加入 LikeCoin button"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-03-12T09:22:50.000Z" title="3/12/2022, 5:22:50 PM">2022-03-12</time>發表</span><span class="level-item"><time dateTime="2022-03-12T17:15:05.385Z" title="3/13/2022, 1:15:05 AM">2022-03-13</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Hexo/">Hexo</a></span><span class="level-item">6 分鐘讀完 (大約870個字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/12/%E5%A6%82%E4%BD%95%E5%9C%A8-Hexo-%E9%96%8B%E7%99%BC%E7%92%B0%E5%A2%83%E7%9A%84%E6%96%87%E7%AB%A0%E4%B8%AD%E5%8A%A0%E5%85%A5-LikeCoin-button/">[Hexo] 如何在 Hexo 開發環境的文章中加入 LikeCoin button</a></h1><div class="content"><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>LikeCoin 是一種加密虛擬貨幣，基於以太坊區塊鏈鎖延伸出來的代幣。不知道大家是不是在瀏覽網站是不是常常看到像 Medium 拍手按鈕， LikeCoin 基金會會依據別人給創作者的按讚數配發其發行虛擬幣幣給創作者，當 LikeCoin 數達到 2,000 時就可以兌換成法定貨幣。我想在自己的 Hexo 網頁放置 LikeCoin 主要原因為我很喜歡它的配色、 Logo 的設計，另一個原因是欣賞它的創作生態圈治理理念。</p>
<h3 id="LikeCoin-加入到-Hexo"><a href="#LikeCoin-加入到-Hexo" class="headerlink" title="LikeCoin 加入到 Hexo"></a>LikeCoin 加入到 Hexo</h3><blockquote>
<p>本篇文章是以 Hexo icarus 主題設定為主，且預設您已經註冊 LikeCoin 。</p>
</blockquote>
<p>官方網站是以 Hexo next 主題為範例，而我的主題目前是使用 icarus ， next 的模板引擎是用 ejs ，而 icarus 則是用 React 的 jsx ，所以設定上就有些許不同。</p>
<p><img src="https://i.imgur.com/mBMh5W0.png"></p>
<h4 id="LikeCoin-button-Gitbook-官方範例"><a href="#LikeCoin-button-Gitbook-官方範例" class="headerlink" title="LikeCoin button Gitbook 官方範例"></a>LikeCoin button Gitbook 官方範例</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="handlebars"><span class="xml"></span></span></span><br><span class="line"><span class="xml"><span class="handlebars">    document.write(</span></span></span><br><span class="line"><span class="xml"><span class="handlebars">      &quot;<span class="tag">&lt;<span class="name">iframe</span> <span class="attr">scrolling</span>=<span class="string">&#x27;no&#x27;</span> <span class="attr">frameborder</span>=<span class="string">&#x27;0&#x27;</span> <span class="attr">sandbox</span>=<span class="string">&#x27;allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox allow-storage-access-by-user-activation&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;height: 212px; width: 100%;&#x27;</span> <span class="attr">src</span>=<span class="string">&#x27;https://button.like.co/in/embed/[LikerID]/button?referrer=&quot; +</span></span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="xml"><span class="handlebars">      encodeURIComponent(location.href.split(&quot;?&quot;)[0].split(&quot;#&quot;)[0]) + &quot;&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span>&quot;);</span></span></span><br><span class="line"><span class="xml"><span class="handlebars">  </span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>icarus 主題預設可以設定 donate 的連結，可以透過 <code>_config.icarus.yml</code> 去做設定，它根據 yml 屬性找到對應連結的圖片，再渲染到前端頁面的卡片上。</p>
<p><img src="https://i.imgur.com/h8iVOHn.png" alt="Image"></p>
<h5 id="config-icarus-yml"><a href="#config-icarus-yml" class="headerlink" title="_config.icarus.yml"></a>_config.icarus.yml</h5><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">donates:</span></span><br><span class="line">    <span class="comment"># &quot;Buy me a coffee&quot; donate button configurations</span></span><br><span class="line">    <span class="bullet">-</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">buymeacoffee</span></span><br><span class="line">        <span class="comment"># URL to the &quot;Buy me a coffee&quot; page</span></span><br><span class="line">        <span class="attr">url:</span> <span class="string">&#x27;你的buymeacoffee URL&#x27;</span></span><br><span class="line">    <span class="comment"># Paypal donate button configurations</span></span><br><span class="line">    <span class="bullet">-</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">paypal</span></span><br><span class="line">        <span class="comment"># Paypal business ID or email address</span></span><br><span class="line">        <span class="attr">business:</span> <span class="string">&#x27;paypal ID&#x27;</span></span><br><span class="line">        <span class="comment"># Currency code</span></span><br><span class="line">        <span class="attr">currency_code:</span> <span class="string">USD</span> <span class="comment">#收款幣別</span></span><br></pre></td></tr></table></figure>

<h4 id="donates-jsx-原始碼"><a href="#donates-jsx-原始碼" class="headerlink" title="donates.jsx 原始碼"></a>donates.jsx 原始碼</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> logger = <span class="built_in">require</span>(<span class="string">&#x27;hexo-log&#x27;</span>)();</span><br><span class="line"><span class="keyword">const</span> &#123; Component &#125; = <span class="built_in">require</span>(<span class="string">&#x27;inferno&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> view = <span class="built_in">require</span>(<span class="string">&#x27;hexo-component-inferno/lib/core/view&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; config, helper &#125; = <span class="built_in">this</span>.props;</span><br><span class="line">        <span class="keyword">const</span> &#123; __ &#125; = helper;</span><br><span class="line">        <span class="keyword">const</span> &#123; donates = [] &#125; = config;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(donates) || !donates.length) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">&quot;menu-label has-text-centered&quot;</span>&gt;</span>&#123;__(&#x27;donate.title&#x27;)&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;buttons is-centered&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    &#123;donates.map(service =&gt; &#123;</span></span><br><span class="line"><span class="xml">                        const type = service.type;</span></span><br><span class="line"><span class="xml">                        if (typeof type === &#x27;string&#x27;) &#123;</span></span><br><span class="line"><span class="xml">                            try &#123;</span></span><br><span class="line"><span class="xml">                                let Donate = view.require(&#x27;donate/&#x27; + type);</span></span><br><span class="line"><span class="xml">                                Donate = Donate.Cacheable ? Donate.Cacheable : Donate;</span></span><br><span class="line"><span class="xml">                                return <span class="tag">&lt;<span class="name">Donate</span> <span class="attr">helper</span>=<span class="string">&#123;helper&#125;</span> <span class="attr">donate</span>=<span class="string">&#123;service&#125;</span> /&gt;</span>;</span></span><br><span class="line"><span class="xml">                            &#125; catch (e) &#123;</span></span><br><span class="line"><span class="xml">                                logger.w(`Icarus cannot load donate button &quot;$&#123;type&#125;&quot;`);</span></span><br><span class="line"><span class="xml">                            &#125;</span></span><br><span class="line"><span class="xml">                        &#125;</span></span><br><span class="line"><span class="xml">                        return null;</span></span><br><span class="line"><span class="xml">                    &#125;)&#125;</span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="魔改-icarus-原始碼"><a href="#魔改-icarus-原始碼" class="headerlink" title="魔改 icarus 原始碼"></a>魔改 icarus 原始碼</h3><p>由於我是使用 npm 下載主題，所以主題外框、文章、頁面元件會放在你資料夾的 <code>node_modules/hexo-theme-icarus/layout/common/</code> 底下，我是在 common 資料夾底下新建一個 jsx 檔元件，此元件去繼承 React.Component ，繼承下來的 sub class 去覆寫 render() 方法，我們方法回傳官方網站提供 iframe 標籤的內容，iframe src 屬性的 [LikerID] 換成自己的 LikerID ，最後我們將建立好的類別輸出出去，我的檔案取名叫 <code>likecoin.jsx</code>。</p>
<h4 id="likecoin-jsx"><a href="#likecoin-jsx" class="headerlink" title="likecoin.jsx"></a>likecoin.jsx</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; Component &#125; = <span class="built_in">require</span>(<span class="string">&#x27;inferno&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">scrolling</span>=<span class="string">&#x27;no&#x27;</span> <span class="attr">frameborder</span>=<span class="string">&#x27;0&#x27;</span> <span class="attr">sandbox</span>=<span class="string">&#x27;allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox allow-storage-access-by-user-activation&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;height: 212px; width: 100%;&#x27;</span> <span class="attr">src</span>=<span class="string">&#x27;https://button.like.co/in/embed/[LikerID]/button?referrer=&quot; + encodeURIComponent(location.href.split(&quot;?&quot;)[0].split(&quot;#&quot;)[0]) + &quot;&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>原先包住在 <code>&lt;div class=&quot;buttons is-centered&quot;&gt;...&lt;/div&gt;</code>  原始碼以迭代方式尋找在使用者在 <code>_config.icarus.yml</code> 設定的 donate type 有沒有在對應的type，再把type帶進去 Donate渲染出來，那我們要改的就是這一段，接著我們將 likecoin.jsx 引入到 donates.jsx ，使用標籤將元件包住，並取代剛剛我們提到的地方，由於我們不需要再透過 config 檔尋找 donate type ，所以我有把 <code>_config.icarus.yml</code> donate 那一塊刪掉，原始碼原本判斷 donates 是否為陣列及陣列長度也一併移除。</p>
<h4 id="donates-jsx"><a href="#donates-jsx" class="headerlink" title="donates.jsx"></a>donates.jsx</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> logger = <span class="built_in">require</span>(<span class="string">&#x27;hexo-log&#x27;</span>)();</span><br><span class="line"><span class="keyword">const</span> &#123; Component &#125; = <span class="built_in">require</span>(<span class="string">&#x27;inferno&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> LikeCoin = <span class="built_in">require</span>(<span class="string">&#x27;./likecoin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> view = <span class="built_in">require</span>(<span class="string">&#x27;hexo-component-inferno/lib/core/view&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; helper &#125; = <span class="built_in">this</span>.props;</span><br><span class="line">        <span class="keyword">const</span> &#123; __ &#125; = helper;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">&quot;menu-label has-text-centered&quot;</span>&gt;</span>&#123;__(&#x27;donate.title&#x27;)&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;is-centered&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">LikeCoin</span>&gt;</span><span class="tag">&lt;/<span class="name">LikeCoin</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/fd5Da2R.png"></p>
<h3 id="參考資源"><a href="#參考資源" class="headerlink" title="參考資源"></a>參考資源</h3><ol>
<li><p><a target="_blank" rel="noopener" href="https://docs.like.co/v/zh/user-guide/creator/self-host/hexo-next">如何在 Hexo 開發環境的文章中加入 LikeCoin button</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://zh-hant.reactjs.org/docs/react-component.html">React.Component</a></p>
</li>
</ol>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2022/03/12/Heroku-Couldn-t-find-that-process-type-web/"><img class="fill" src="https://images.unsplash.com/photo-1433538534219-56b38a74c4c3?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=1770&amp;q=80" alt="[Heroku][Flask] Couldn&#039;t find that process type (web)."></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-03-12T06:20:20.000Z" title="3/12/2022, 2:20:20 PM">2022-03-12</time>發表</span><span class="level-item"><time dateTime="2022-03-12T07:08:38.480Z" title="3/12/2022, 3:08:38 PM">2022-03-12</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Heroku/">Heroku</a></span><span class="level-item">4 分鐘讀完 (大約535個字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/12/Heroku-Couldn-t-find-that-process-type-web/">[Heroku][Flask] Couldn&#039;t find that process type (web).</a></h1><div class="content"><h3 id="問題描述"><a href="#問題描述" class="headerlink" title="問題描述"></a>問題描述</h3><p>朋友想製造一個 LINE 機器人，自學學習撰寫 Python Flask Web Framework ，並部署到 Heroku 上，預期傳訊息時機器人會自動回覆相同的訊息內容，但卻沒有顯示在對話視窗內，於是拜託我幫他看。</p>
<p>首先要看的就是 Heroku console log ，下 <code>heroku logs --tail</code> 從裡面一定可以找出一些蛛絲馬跡，果不其然看到一些訊息，從日誌檔可得知程式是包版成功的，但很顯然程式發生錯誤， Web server 根本就沒有啟動，官方網站給出的解決方法是下 <code>heroku ps:scale web=1</code> 這組指令，以手動方式將 Web server 程序部署到他們的引擎 dyno 上。</p>
<h4 id="Heroku-上日誌檔"><a href="#Heroku-上日誌檔" class="headerlink" title="Heroku 上日誌檔"></a>Heroku 上日誌檔</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2022-03-12T05:20:20.000000+00:00 app[api]: Build succeeded</span><br><span class="line">2022-03-12T05:20:30.962092+00:00 heroku[router]: at=error code=H14 desc=&quot;No web processes running&quot; method=GET path=&quot;/favicon.ico&quot; host=groupbuyingchatbot.herokuapp.com request_id=808970d4-836d-40e6-9f8a-1e3b3a999199 fwd=&quot;42.77.131.204&quot; dyno= connect= service= status=503 bytes= protocol=https</span><br></pre></td></tr></table></figure>

<h4 id="Heroku-H14-錯誤代碼解釋"><a href="#Heroku-H14-錯誤代碼解釋" class="headerlink" title="Heroku H14 錯誤代碼解釋"></a>Heroku H14 錯誤代碼解釋</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">H14 - No web dynos running</span><br><span class="line">This is most likely the result of scaling your web dynos down to 0 dynos. To fix it, scale your web dynos to 1 or more dynos:</span><br><span class="line"></span><br><span class="line">heroku ps:scale web=1</span><br><span class="line">Use the heroku ps command to determine the state of your web dynos.</span><br><span class="line"></span><br><span class="line">2010-10-06T21:51:37-07:00 heroku[router]: at=error code=H14 desc=&quot;No web processes running&quot; method=GET path=&quot;/&quot; host=myapp.herokuapp.com fwd=17.17.17.17 dyno= connect= service= status=503 bytes=</span><br></pre></td></tr></table></figure>

<p>你以這樣就解決問題了嗎？並沒有！我下了這道指令回覆訊息仍是找不是 Web Server 的程序，後續我確認了 Python 有沒有語法上的錯誤、部署腳本、套件 requirements.txt，也嘗試在本機上執行，皆無問題。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gordonfang$ heroku ps:scale web=1</span><br><span class="line">Scaling dynos... !</span><br><span class="line">!   couldn&#x27;t find that process type (web).</span><br></pre></td></tr></table></figure>

<h3 id="解決方法"><a href="#解決方法" class="headerlink" title="解決方法"></a>解決方法</h3><p>隔一天再次檢查才發現原來朋友寫的 Procfile 多了副檔名，是 Procfile.txt ， Procfile 是 Heroku 的部署腳本，告訴他包版完後要跑哪一個檔案將 Web Server 啟動起來，重新調整完後機器人就能順利回覆訊息。</p>
<p> <img src="https://i.imgur.com/ueDnSAf.png" alt="Image"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@handler.add(<span class="params">MessageEvent, message=TextMessage</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">handle_message</span>(<span class="params">event</span>):</span></span><br><span class="line">    message = text=event.message.text</span><br><span class="line">    line_bot_api.reply_message(event.reply_token, TextSendMessage(message))</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2022/03/08/BigDecimal-%E7%B2%BE%E5%BA%A6%E8%A8%88%E7%AE%97/"><img class="fill" src="https://images.unsplash.com/photo-1638913658828-afb88c3d4d11?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDF8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=1470&amp;q=80" alt="[Java] BigDecimal 精度計算"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-03-07T16:45:09.000Z" title="3/8/2022, 12:45:09 AM">2022-03-08</time>發表</span><span class="level-item"><time dateTime="2022-03-10T15:24:19.555Z" title="3/10/2022, 11:24:19 PM">2022-03-10</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Java/">Java</a></span><span class="level-item">4 分鐘讀完 (大約605個字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/08/BigDecimal-%E7%B2%BE%E5%BA%A6%E8%A8%88%E7%AE%97/">[Java] BigDecimal 精度計算</a></h1><div class="content"><h3 id="問題"><a href="#問題" class="headerlink" title="問題"></a>問題</h3><p>實務上，我們在程式中處理與金錢相關的議題不會使用浮點數，因為那會造成 Truncate Error，算出來的金額會有浮點數誤差，通常我們會使用 BigDecimal 來計算，提高計算的精度。</p>
<p>而我曾經要計算某金額除以匯率，計算結果四捨五入小數點取到第二位，於是我就寫了以下範例，使用 BigDecimal 除法，分別填入除數與 MathContext ， MathContext 的建構子的第一參數 setPrecision ，我以為設定的是小數點的精度，但事與願達，結果是<code>2.4E2</code>即 240 以科學記號表示。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">BigDecimal dividend = <span class="keyword">new</span> BigDecimal(<span class="string">&quot;999999.9999&quot;</span>);</span><br><span class="line">BigDecimal divisor = <span class="keyword">new</span> BigDecimal(<span class="string">&quot;4096.00&quot;</span>);</span><br><span class="line">BigDecimal result = dividend.divide(divisor, <span class="keyword">new</span> MathContext(<span class="number">2</span>, RoundingMode.HALF_UP));</span><br><span class="line">System.out.println(result);</span><br></pre></td></tr></table></figure>


<h3 id="Scale-Precision傻傻分不清楚"><a href="#Scale-Precision傻傻分不清楚" class="headerlink" title="Scale, Precision傻傻分不清楚"></a>Scale, Precision傻傻分不清楚</h3><p>由於上述計算結果並不是我想要，我在網路上找到 BigDecimal 對 Scale , Precision 的介紹，我才赫然發現一開始我就搞錯用法了，原來 BigDecimal 也像 IEEE-754 採用類似的表示方式。</p>
<h4 id="BigDecimal表示法"><a href="#BigDecimal表示法" class="headerlink" title="BigDecimal表示法"></a>BigDecimal表示法</h4><blockquote>
<p>Java BigDecimal 是由兩個數值所構成的，分別是隨機的精度整數、跟 32 位元整數範圍，通常BigDecimal以<img src="https://chart.googleapis.com/chart?cht=tx&chl=unscaledValue%5Ctimes10%5E%7B-scale%7D">表示，其中n為小數位數。</p>
</blockquote>
<h4 id="Precision"><a href="#Precision" class="headerlink" title="Precision"></a>Precision</h4><blockquote>
<p>精度定義是未經 BigDecimal 正規表示的數值之位數，即該數值整數加上小數的數位，例如： 123.45 ，此精度會回傳 5 。</p>
</blockquote>
<h4 id="Scale"><a href="#Scale" class="headerlink" title="Scale"></a>Scale</h4><blockquote>
<p>範圍定義是經 BigDecimal 正規表示後的小數位數，如果 Scale 是零、正整數，則會將該數的數個位數挪動到小數點符號的右邊，如若 Scale 是負整數，則該值會乘上 10 的幂次，例如： 12345 ， scale = 2，則回傳 123.45 ， 12345 ， scale = -1 ，則回傳 123450 。</p>
</blockquote>
<h3 id="解決方法"><a href="#解決方法" class="headerlink" title="解決方法"></a>解決方法</h3><p>承上述例子，因為精度是設定 2 ，舊版的寫法會造成四捨五入到十位數，十數位以下通通進位，並以科學記號表示。解決方法是改用 BigDecimal 另一個重載 divide 的方法，就可以在第二參數設定小數範圍為 2 ，最後結果為<code>244.14</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BigDecimal</span> <span class="keyword">extends</span> <span class="title">Number</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">BigDecimal</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> BigDecimal <span class="title">divide</span><span class="params">(BigDecimal divisor, <span class="keyword">int</span> scale, RoundingMode roundingMode)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> divide(divisor, scale, roundingMode.oldMode);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">BigDecimal dividend = <span class="keyword">new</span> BigDecimal(<span class="string">&quot;999999.9999&quot;</span>);</span><br><span class="line">BigDecimal divisor = <span class="keyword">new</span> BigDecimal(<span class="string">&quot;4096.00&quot;</span>);</span><br><span class="line">BigDecimal result = dividend.divide(divisor, <span class="number">2</span>, RoundingMode.HALF_UP);</span><br><span class="line">System.out.println(result);</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2022/03/07/%5BSpring%5D%20Set%20exposeProxy%20property%20on%20Advised%20to%20true/"><img class="fill" src="https://images.unsplash.com/photo-1584734622529-6bb653236eea?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=687&amp;q=80" alt="[Spring] Set exposeProxy property on Advised to true"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-03-06T16:35:13.000Z" title="3/7/2022, 12:35:13 AM">2022-03-07</time>發表</span><span class="level-item"><time dateTime="2022-03-07T16:22:42.253Z" title="3/8/2022, 12:22:42 AM">2022-03-08</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Spring-Boot/">Spring Boot</a></span><span class="level-item">5 分鐘讀完 (大約679個字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/07/%5BSpring%5D%20Set%20exposeProxy%20property%20on%20Advised%20to%20true/">[Spring] Set exposeProxy property on Advised to true</a></h1><div class="content"><h3 id="問題描述"><a href="#問題描述" class="headerlink" title="問題描述"></a>問題描述</h3><p>我在工作上有一個需求需要使用多執行緒完整多個工項，每一個工作都是獨立事務交易，所以我使用Java 8 CompletableFuture提供的方法實作Runnable，再利用Spring AOP代理機制處理事務交易，但當我發送Http Request到我的AP Server時，卻收到下述報錯訊息，從中可以得知發生此錯誤的原因有兩種可能，一、沒有打開代理<code>Java @EnableAspectJAutoProxy(exposeProxy = true, proxyTargetClass = true)</code>，另一個可能是不是在同一條執行緒使用代理機制，後來我才意識到我使用了不同的執行緒代理是無法生效的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.util.concurrent.ExecutionException: java.lang.IllegalStateException: Cannot find current proxy: Set exposeProxy property on Advised to &#x27;true&#x27; to make it available, and ensure that AopContext.currentProxy() is invoked in the same thread as the AOP invocation context.</span><br></pre></td></tr></table></figure>

<p>我就好奇為什麼AOP代理機制為不能跨執行緒，於是我去翻AopContext的source code，我才發現原來它是從ThreadLocal取得目前的代理類別，ThreadLocal本身特性就專屬於一個執行緒使用，其他的執行緒不能存取、修改。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">AopContext</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ThreadLocal&lt;Object&gt; currentProxy = <span class="keyword">new</span> NamedThreadLocal&lt;&gt;(<span class="string">&quot;Current AOP proxy&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="title">AopContext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">currentProxy</span><span class="params">()</span> <span class="keyword">throws</span> IllegalStateException </span>&#123;</span><br><span class="line">		Object proxy = currentProxy.get();</span><br><span class="line">		<span class="keyword">if</span> (proxy == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(</span><br><span class="line">					<span class="string">&quot;Cannot find current proxy: Set &#x27;exposeProxy&#x27; property on Advised to &#x27;true&#x27; to make it available, and &quot;</span> +</span><br><span class="line">							<span class="string">&quot;ensure that AopContext.currentProxy() is invoked in the same thread as the AOP invocation context.&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> proxy;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="範例"><a href="#範例" class="headerlink" title="範例"></a>範例</h3><p>以下範例模擬我當時工作時發生的錯誤，在raiseEmployeeSalary()先到MongoDB撈所有員工的資料後，以多執行緒方式替員工加薪數額，由raiseSalary()完成，CompletableFuture.allOf意思是等所有員工加完薪水後，繼續往下作。如同上一節我所描述的，在透過代理機制去呼叫raiseSalary()就會報錯。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmployeeService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmployeeDao employeeDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional(rollbackFor = Exception.class, propagation = Propagation.REQUIRED)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">raiseEmployeeSalary</span><span class="params">(RaiseSalaryBo raiseSalaryBo)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException </span>&#123;</span><br><span class="line">        List&lt;Employee&gt; employees = employeeDao.listAllEmployees();</span><br><span class="line"></span><br><span class="line">        List&lt;CompletableFuture&lt;?&gt;&gt; tasks = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Employee employee : employees) &#123;</span><br><span class="line">            tasks.add(CompletableFuture.runAsync(()-&gt;((EmployeeService)AopContext.currentProxy()).raiseSalary(employee, raiseSalaryBo.getBonus())));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        CompletableFuture.allOf(tasks.toArray(<span class="keyword">new</span> CompletableFuture&lt;?&gt;[<span class="number">0</span>])).get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional(rollbackFor = Exception.class, propagation = Propagation.REQUIRES_NEW)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">raiseSalary</span><span class="params">(Employee employee, BigDecimal bonus)</span> </span>&#123;</span><br><span class="line">        employeeDao.raiseSalary(employee, bonus);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="解決方法"><a href="#解決方法" class="headerlink" title="解決方法"></a>解決方法</h3><p>解決方法十分簡單，如若真的需要切割出子事務交易，那就不能使多執行緒來處理，依據上述範例必須把CompletableFuture移除，程式才能正常執行。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmployeeService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmployeeDao employeeDao;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Transactional(rollbackFor = Exception.class, propagation = Propagation.REQUIRED)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">raiseEmployeeSalary</span><span class="params">(RaiseSalaryBo raiseSalaryBo)</span> </span>&#123;</span><br><span class="line">        List&lt;Employee&gt; employees = employeeDao.listAllEmployees();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Employee employee : employees) &#123;</span><br><span class="line">            ((EmployeeService) AopContext.currentProxy()).raiseSalary(employee, raiseSalaryBo.getBonus());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional(rollbackFor = Exception.class, propagation = Propagation.REQUIRES_NEW)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">raiseSalary</span><span class="params">(Employee employee, BigDecimal bonus)</span> </span>&#123;</span><br><span class="line">        employeeDao.raiseSalary(employee, bonus);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="資料庫更新後的結果"><a href="#資料庫更新後的結果" class="headerlink" title="資料庫更新後的結果"></a>資料庫更新後的結果</h4><p><img src="https://i.imgur.com/MIrK0UZ.png" alt="Image"></p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2022/02/28/%E7%A0%94%E7%A9%B6%E6%89%80%E6%94%BE%E6%A6%9C%E5%89%8D%E5%BF%83%E5%BE%97/"><img class="fill" src="https://images.unsplash.com/photo-1439405326854-014607f694d7?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=1470&amp;q=80" alt="研究所放榜前心得"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-02-28T12:05:15.000Z" title="2/28/2022, 8:05:15 PM">2022-02-28</time>發表</span><span class="level-item"><time dateTime="2022-03-01T17:15:56.609Z" title="3/2/2022, 1:15:56 AM">2022-03-02</time>更新</span><span class="level-item">10 分鐘讀完 (大約1432個字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/02/28/%E7%A0%94%E7%A9%B6%E6%89%80%E6%94%BE%E6%A6%9C%E5%89%8D%E5%BF%83%E5%BE%97/">研究所放榜前心得</a></h1><div class="content"><h2 id="一、心境"><a href="#一、心境" class="headerlink" title="一、心境"></a>一、心境</h2><h3 id="在學期間"><a href="#在學期間" class="headerlink" title="在學期間"></a>在學期間</h3><p>在尚未步入社會前，我和大多數的抱持升學的學生心態是一樣的，看著大家報考研究所，自己也跟著報考，比較少去思考為何而報？上了之後要從事什麼研究？大部分會報名的學生不外乎受長輩們的建議影響，為了謀一個好的前途而去報考各校系，某種程度上，<strong>部分</strong>大學生對批判性、與獨立性思考欠佳。</p>
<h3 id="步入社會"><a href="#步入社會" class="headerlink" title="步入社會"></a>步入社會</h3><p>由於自己考資管所在18、19年雙雙落榜，家裡的經濟迫在眉睫，我不得不暫停考研的計畫，轉換跑道到求職，所幸在家鄉獲得軟體工程師的職缺，我慶幸準備考研的知識能應用在工作上，尤其在程式開發上，可以說資料結構、與Java程式語言讓我在這份工作上站穩腳跟。</p>
<p>入職後的我曾與幾位同事談論過適不適合再考研究所，多數同事是持反對意見，既然有份正當的工作何苦再給自己找麻煩，且畢業後還得重新找工作，研究所並不會為我帶來太大的加分，即便我有相關的工作經驗，人資仍視我為新人。</p>
<h2 id="二、研究所報考動機"><a href="#二、研究所報考動機" class="headerlink" title="二、研究所報考動機"></a>二、研究所報考動機</h2><p>會報考的主要兩個因素，其一，在大學就讀期間深受專題指導教授的鼓勵，她支持我繼續再往上讀，其二，也是受大學教授影響，我曾就學期間修過一門課叫「影像處理」，在那門課習得使用Matalb、Java對數位影像進行初階操作，印象最深刻莫過於「色彩量化」與「影像藏密學」，我可以說是我大學四年修過最好玩的課，且我願意再多花兩年專研<strong>電腦視覺領域</strong>的知識。</p>
<p>影像存在電腦裡頭其實就是二維矩陣，可想而知多多少少都會用到線性代數進行運算，對於數學很爛的我的確嚇阻了我不少，但美國前總統杜魯門曾說過：「怕熱就不要進廚房」，既然要走這個領域就不畏懼數學。</p>
<h2 id="三、補習班生活"><a href="#三、補習班生活" class="headerlink" title="三、補習班生活"></a>三、補習班生活</h2><p>我是到21年才決定報補習班，因為補習班教材完整，可以省去不少時間蒐集教材來看，但如今我看來當初決策有點錯誤。</p>
<ol>
<li>報錯組？<br>資管所分成兩個組別報考，一直一來我都報考科技組，一般都是準備兩科，資料結構與計算機概論，而資管組則是資料結構換成管理資訊系統，我是到很後期才認知到自己真的不適合報資管組，管理論述欠佳，尤其是推導方面，最後在考前幾個月仍報科技組。</li>
</ol>
<p>雖然說一開始上MIS正課我認為是錯誤的決定，但不代表老師上的不好，確實老師帶給我很大的啟發，重新思考資訊系統在企業中的定位、策略，不得不說丁棋老師是我遇過MIS上得最好的老師。</p>
<ol start="2">
<li>報錯系所？<br>誠如第二點的說明，我和其他考生考研目的不同在於我不是求職導向，而是學習研究導向，且我有特定的研究目標。根據我自身的觀察，資管所的老師十分喜歡做研究，但大多研究仍與商業脫離不了關係，很少教授有開設電腦視覺相關的實驗室，我是近幾天才認知到我有興趣的研究領域可能集中在資工系底下的研究所，如：台大網路及多媒體研究所、陽明交大多媒體研究所、清大資訊應用系統研究所…等，其中我只報清大資應所，且錄取率真的是不高，約不到3%。</li>
</ol>
<p>從以上兩點來看，我應該是被資管系給綁住，因為我從高職就是唸相關的科系上來的，不曾想過可以跳出框架，而非在乎畢業證書上是否也印製資管兩字，我想這也是我自己設下的<strong>圈套</strong>，如今看來是已經解開了。</p>
<ol start="3">
<li>回首過去<br>因為我是在職考生的身份，比其他考生累得許多，不但白天要應付公司系統開發建置，晚上也要應付補習班的作業、小考、複習包羅萬象計概出題範圍，基本上過去的一年假日都是在補習班、圖書館、咖啡廳、讀書會度過的，毫無娛樂可言，在生活枯燥同時，我很感謝一路走來的戰友，陪我成長，互相切磋，討論各校的考古題。</li>
</ol>
<p>我不認為我是個聰明的人，否則也不會從17年考到現在，考到我周遭的同學碩士都畢業了，我還在繼續奮鬥，我很佩服我的堅忍不拔的意志力、及對學習的熱忱，想對自己說辛苦了，願努力最後能化作一片天。</p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2021/06/27/%5BLeetCode%5D%20844.%20Backspace%20String%20Compare/"><img class="fill" src="https://images.unsplash.com/photo-1586943759341-be5595944989?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=1050&amp;q=80" alt="[LeetCode] 844. Backspace String Compare"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-06-27T15:40:00.000Z" title="6/27/2021, 11:40:00 PM">2021-06-27</time>發表</span><span class="level-item"><time dateTime="2021-06-27T16:16:36.390Z" title="6/28/2021, 12:16:36 AM">2021-06-28</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/LeetCode/">LeetCode</a></span><span class="level-item">4 分鐘讀完 (大約543個字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/06/27/%5BLeetCode%5D%20844.%20Backspace%20String%20Compare/">[LeetCode] 844. Backspace String Compare</a></h1><div class="content"><h1 id="題目連結"><a href="#題目連結" class="headerlink" title="題目連結"></a>題目連結</h1><p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/backspace-string-compare/">844. Backspace String Compare</a></p>
<h1 id="問題描述"><a href="#問題描述" class="headerlink" title="問題描述"></a>問題描述</h1><p>Given two strings s and t, return true if they are equal when both are typed into empty text editors. ‘#’ means a backspace character.</p>
<p>Note that after backspacing an empty text, the text will continue empty.</p>
<h2 id="Example-1"><a href="#Example-1" class="headerlink" title="Example 1:"></a>Example 1:</h2><p>Input: s = “ab#c”, t = “ad#c”<br>Output: true<br>Explanation: Both s and t become “ac”.<br>Example 2:</p>
<p>Input: s = “ab##”, t = “c#d#”<br>Output: true<br>Explanation: Both s and t become “”.<br>Example 3:</p>
<p>Input: s = “a##c”, t = “#a#c”<br>Output: true<br>Explanation: Both s and t become “c”.<br>Example 4:</p>
<p>Input: s = “a#c”, t = “b”<br>Output: false<br>Explanation: s becomes “c” while t becomes “b”.</p>
<h1 id="翻譯"><a href="#翻譯" class="headerlink" title="翻譯"></a>翻譯</h1><ul>
<li>給定兩字串分別是s、 跟t，被輸入到空的文字編輯器的這兩段字串如果是一樣<br>，則回傳true，#表示一個退格鍵。</li>
<li>請注意在空字串輸入退格鍵，這段文字仍為空白。</li>
</ul>
<h1 id="解題思維"><a href="#解題思維" class="headerlink" title="解題思維"></a>解題思維</h1><h2 id="從字串頭讀到字串尾的解法"><a href="#從字串頭讀到字串尾的解法" class="headerlink" title="從字串頭讀到字串尾的解法"></a>從字串頭讀到字串尾的解法</h2><ol>
<li>準備一個Stack，以迭代方式讀取兩個字串中各個字元，將其儲存到Stack</li>
<li>當讀取到字元是退格鍵#，將目前儲存在Stack第一個字元pop<ul>
<li>‘#’不儲到Stack</li>
</ul>
</li>
<li>最後將仍儲存在Stack的字元輸出成字串，即可以比對兩串字串是否一樣</li>
<li>請參考Java解法</li>
</ol>
<h2 id="從字串尾讀到字串頭的解法"><a href="#從字串尾讀到字串頭的解法" class="headerlink" title="從字串尾讀到字串頭的解法"></a>從字串尾讀到字串頭的解法</h2><ol>
<li>從字串尾開始讀取各個字元</li>
<li>當讀取到字元是退格鍵#，累加變數<ul>
<li>變數用來決定讀取下一個字元是否要跳過</li>
</ul>
</li>
<li>變數大於0，跳過該字元</li>
<li>最後比對去除刪除部分字元字串是否一樣</li>
<li>請參考C++解法</li>
</ol>
<h1 id="解題報告"><a href="#解題報告" class="headerlink" title="解題報告"></a>解題報告</h1><blockquote>
<p>Level: Easy<br>Time Complexity: O(n)<br>Runtime: 0 ms, faster than 100.00% of C++ online submissions for Backspace String Compare.<br>Memory Usage: 6.3 MB, less than 57.92% of C++ online submissions for Backspace String Compare.</p>
</blockquote>
<h1 id="程式完整解題"><a href="#程式完整解題" class="headerlink" title="程式完整解題"></a>程式完整解題</h1><h2 id="Java-解法"><a href="#Java-解法" class="headerlink" title="Java 解法"></a>Java 解法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">backspaceCompare</span><span class="params">(String s, String t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> removeBackSpaces(s).removeBackSpaces(t);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">removeBackSpaces</span><span class="params">(String str)</span></span>&#123;</span><br><span class="line">       Stack&lt;Character&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">       StringBuilder builder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">       <span class="keyword">for</span>(<span class="keyword">char</span> c : str.toCharArray())&#123;</span><br><span class="line">           <span class="keyword">if</span>(c == <span class="string">&#x27;#&#x27;</span>) &#123;</span><br><span class="line">               <span class="keyword">if</span>(!stack.isEmpty()) &#123;</span><br><span class="line">                   stack.pop();</span><br><span class="line">               &#125;</span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">               stack.push(c);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       </span><br><span class="line">       <span class="keyword">while</span>(!stack.isEmpty())&#123;</span><br><span class="line">           builder.append(stack.pop());</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> builder.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="C-解法"><a href="#C-解法" class="headerlink" title="C++ 解法"></a>C++ 解法</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">backspaceCompare</span><span class="params">(string s, string t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">removeBackSpaces</span>(s).<span class="built_in">compare</span>(<span class="built_in">removeBackSpaces</span>(t)) == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function">string <span class="title">removeBackSpaces</span><span class="params">(string str)</span> </span>&#123;</span><br><span class="line">        string newString;</span><br><span class="line">        <span class="keyword">int</span> skip = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = str.<span class="built_in">length</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="keyword">if</span>(str[i] == <span class="string">&#x27;#&#x27;</span>) &#123;</span><br><span class="line">                skip++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(skip &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    skip--;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    newString.<span class="built_in">push_back</span>(str[i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> newString;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2020/07/03/%5BLeetCode%5D%20185.%20Department%20Top%20Three%20Salaries/"><img class="fill" src="https://images.unsplash.com/photo-1531973576160-7125cd663d86?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=1350&amp;q=80" alt="[LeetCode] 185. Department Top Three Salaries"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-07-02T17:00:56.000Z" title="7/3/2020, 1:00:56 AM">2020-07-03</time>發表</span><span class="level-item"><time dateTime="2021-06-27T15:41:44.208Z" title="6/27/2021, 11:41:44 PM">2021-06-27</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/LeetCode/">LeetCode</a></span><span class="level-item">3 分鐘讀完 (大約412個字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/07/03/%5BLeetCode%5D%20185.%20Department%20Top%20Three%20Salaries/">[LeetCode] 185. Department Top Three Salaries</a></h1><div class="content"><h1 id="問題描述"><a href="#問題描述" class="headerlink" title="問題描述"></a>問題描述</h1><p>The Employee table holds all employees. Every employee has an Id, and there is also a column for the department Id.</p>
<table>
<thead>
<tr>
<th>Id</th>
<th>Name</th>
<th>Salary</th>
<th>DepartmentId</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>Joe</td>
<td>85000</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>Henry</td>
<td>80000</td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>Sam</td>
<td>60000</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>Max</td>
<td>90000</td>
<td>1</td>
</tr>
<tr>
<td>5</td>
<td>Janet</td>
<td>69000</td>
<td>1</td>
</tr>
<tr>
<td>6</td>
<td>Randy</td>
<td>85000</td>
<td>1</td>
</tr>
<tr>
<td>7</td>
<td>Will</td>
<td>70000</td>
<td>1</td>
</tr>
</tbody></table>
<p>The Department table holds all departments of the company.</p>
<table>
<thead>
<tr>
<th>Id</th>
<th>Name</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>IT</td>
</tr>
<tr>
<td>2</td>
<td>Sales</td>
</tr>
</tbody></table>
<p>Write a SQL query to find employees who earn the top three salaries in each of the department. For the above tables, your SQL query should return the following rows (order of rows does not matter).</p>
<table>
<thead>
<tr>
<th>Department</th>
<th>Employee</th>
<th>Salary</th>
</tr>
</thead>
<tbody><tr>
<td>IT</td>
<td>Max</td>
<td>90000</td>
</tr>
<tr>
<td>IT</td>
<td>Randy</td>
<td>85000</td>
</tr>
<tr>
<td>IT</td>
<td>Joe</td>
<td>85000</td>
</tr>
<tr>
<td>IT</td>
<td>Will</td>
<td>70000</td>
</tr>
<tr>
<td>Sales</td>
<td>Henry</td>
<td>80000</td>
</tr>
<tr>
<td>Sales</td>
<td>Sam</td>
<td>60000</td>
</tr>
</tbody></table>
<h1 id="翻譯"><a href="#翻譯" class="headerlink" title="翻譯"></a>翻譯</h1><ul>
<li>Employee 表格紀錄員工資訊，每位員工擁有 Id, 及所屬部門代碼。</li>
<li>Department 表格紀錄公司所有部門資訊。</li>
<li>請撰寫一段 SQL 查詢，找出各部門業績排行的前三名，同名並列。</li>
</ul>
<h1 id="解題思維"><a href="#解題思維" class="headerlink" title="解題思維"></a>解題思維</h1><blockquote>
<p>利用 DENSE_RANK()函數以部門代號切割，業績從高至低排名<br>最後撈取前三名(含)，就可得出答案</p>
</blockquote>
<h1 id="解題報告"><a href="#解題報告" class="headerlink" title="解題報告"></a>解題報告</h1><blockquote>
<p>Level: Hard<br>Runtime: 1173 ms, faster than 80.22% of Oracle online submissions for Department Top Three Salaries.<br>Memory Usage: 0B, less than 100.00% of Oracle online submissions for Department Top Three Salaries.</p>
</blockquote>
<h1 id="程式完整解題"><a href="#程式完整解題" class="headerlink" title="程式完整解題"></a>程式完整解題</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Write your PL/SQL query statement below */</span></span><br><span class="line"><span class="keyword">SELECT</span> DEPARTMENT</span><br><span class="line">      ,EMPLOYEE</span><br><span class="line">      ,SALARY</span><br><span class="line">  <span class="keyword">FROM</span>(<span class="keyword">SELECT</span> DP.NAME   <span class="keyword">AS</span> DEPARTMENT</span><br><span class="line">             ,EM.NAME   <span class="keyword">AS</span> EMPLOYEE</span><br><span class="line">             ,EM.SALARY <span class="keyword">AS</span> SALARY</span><br><span class="line">             ,<span class="built_in">DENSE_RANK</span>() <span class="keyword">OVER</span>(<span class="keyword">PARTITION</span> <span class="keyword">BY</span> EM.DEPARTMENTID <span class="keyword">ORDER</span> <span class="keyword">BY</span> EM.SALARY <span class="keyword">DESC</span>) <span class="keyword">AS</span> RANK</span><br><span class="line">         <span class="keyword">FROM</span> EMPLOYEE   EM</span><br><span class="line">         <span class="keyword">JOIN</span> DEPARTMENT DP</span><br><span class="line">           <span class="keyword">ON</span> EM.DEPARTMENTID <span class="operator">=</span> DP.ID)</span><br><span class="line"> <span class="keyword">WHERE</span> RANK <span class="operator">&lt;=</span> <span class="number">3</span>;</span><br></pre></td></tr></table></figure>

<h2 id="SQL-Schema"><a href="#SQL-Schema" class="headerlink" title="SQL Schema"></a>SQL Schema</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> If <span class="keyword">Not</span> <span class="keyword">Exists</span> Employee (Id <span class="type">int</span>, Name <span class="type">varchar</span>(<span class="number">255</span>), Salary <span class="type">int</span>, DepartmentId <span class="type">int</span>)</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> If <span class="keyword">Not</span> <span class="keyword">Exists</span> Department (Id <span class="type">int</span>, Name <span class="type">varchar</span>(<span class="number">255</span>))</span><br><span class="line"><span class="keyword">Truncate</span> <span class="keyword">table</span> Employee</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Employee (Id, Name, Salary, DepartmentId) <span class="keyword">values</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;Joe&#x27;</span>, <span class="string">&#x27;85000&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Employee (Id, Name, Salary, DepartmentId) <span class="keyword">values</span> (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;Henry&#x27;</span>, <span class="string">&#x27;80000&#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Employee (Id, Name, Salary, DepartmentId) <span class="keyword">values</span> (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;Sam&#x27;</span>, <span class="string">&#x27;60000&#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Employee (Id, Name, Salary, DepartmentId) <span class="keyword">values</span> (<span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;Max&#x27;</span>, <span class="string">&#x27;90000&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Employee (Id, Name, Salary, DepartmentId) <span class="keyword">values</span> (<span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;Janet&#x27;</span>, <span class="string">&#x27;69000&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Employee (Id, Name, Salary, DepartmentId) <span class="keyword">values</span> (<span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;Randy&#x27;</span>, <span class="string">&#x27;85000&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Employee (Id, Name, Salary, DepartmentId) <span class="keyword">values</span> (<span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;Will&#x27;</span>, <span class="string">&#x27;70000&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="keyword">Truncate</span> <span class="keyword">table</span> Department</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Department (Id, Name) <span class="keyword">values</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;IT&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Department (Id, Name) <span class="keyword">values</span> (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;Sales&#x27;</span>)</span><br></pre></td></tr></table></figure>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2020/07/03/%5BLeetCode%5D%20262.%20Trips%20and%20Users/"><img class="fill" src="https://images.unsplash.com/photo-1468689210283-44a1b8ba20ce?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=1350&amp;q=80" alt="[LeetCode] 262. Trips and Users"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-07-02T16:33:01.000Z" title="7/3/2020, 12:33:01 AM">2020-07-03</time>發表</span><span class="level-item"><time dateTime="2021-06-27T15:42:04.771Z" title="6/27/2021, 11:42:04 PM">2021-06-27</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/LeetCode/">LeetCode</a></span><span class="level-item">7 分鐘讀完 (大約1007個字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/07/03/%5BLeetCode%5D%20262.%20Trips%20and%20Users/">[LeetCode] 262. Trips and Users</a></h1><div class="content"><h1 id="問題描述"><a href="#問題描述" class="headerlink" title="問題描述"></a>問題描述</h1><p>The Trips table holds all taxi trips. Each trip has a unique Id, while Client_Id and Driver_Id are both foreign keys to the Users_Id at the Users table. Status is an ENUM type of (‘completed’, ‘cancelled_by_driver’, ‘cancelled_by_client’).</p>
<table>
<thead>
<tr>
<th>Id</th>
<th>Client_Id</th>
<th>Driver_Id</th>
<th>City_Id</th>
<th>Status</th>
<th>Request_at</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>1</td>
<td>10</td>
<td>1</td>
<td>completed</td>
<td>2013-10-01</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>11</td>
<td>1</td>
<td>cancelled_by_driver</td>
<td>2013-10-01</td>
</tr>
<tr>
<td>3</td>
<td>3</td>
<td>12</td>
<td>6</td>
<td>completed</td>
<td>2013-10-01</td>
</tr>
<tr>
<td>4</td>
<td>4</td>
<td>13</td>
<td>6</td>
<td>cancelled_by_client</td>
<td>2013-10-01</td>
</tr>
<tr>
<td>5</td>
<td>1</td>
<td>10</td>
<td>1</td>
<td>completed</td>
<td>2013-10-02</td>
</tr>
<tr>
<td>6</td>
<td>2</td>
<td>11</td>
<td>6</td>
<td>completed</td>
<td>2013-10-02</td>
</tr>
<tr>
<td>7</td>
<td>3</td>
<td>12</td>
<td>6</td>
<td>completed</td>
<td>2013-10-02</td>
</tr>
<tr>
<td>8</td>
<td>2</td>
<td>12</td>
<td>12</td>
<td>completed</td>
<td>2013-10-03</td>
</tr>
<tr>
<td>9</td>
<td>3</td>
<td>10</td>
<td>12</td>
<td>completed</td>
<td>2013-10-03</td>
</tr>
<tr>
<td>10</td>
<td>4</td>
<td>13</td>
<td>12</td>
<td>cancelled_by_driver</td>
<td>2013-10-03</td>
</tr>
</tbody></table>
<p>The Users table holds all users. Each user has an unique Users_Id, and Role is an ENUM type of (‘client’, ‘driver’, ‘partner’).</p>
<table>
<thead>
<tr>
<th>Users_Id</th>
<th>Banned</th>
<th>Role</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>No</td>
<td>client</td>
</tr>
<tr>
<td>2</td>
<td>Yes</td>
<td>client</td>
</tr>
<tr>
<td>3</td>
<td>No</td>
<td>client</td>
</tr>
<tr>
<td>4</td>
<td>No</td>
<td>client</td>
</tr>
<tr>
<td>10</td>
<td>No</td>
<td>driver</td>
</tr>
<tr>
<td>11</td>
<td>No</td>
<td>driver</td>
</tr>
<tr>
<td>12</td>
<td>No</td>
<td>driver</td>
</tr>
<tr>
<td>13</td>
<td>No</td>
<td>driver</td>
</tr>
</tbody></table>
<p>Write a SQL query to find the cancellation rate of requests made by unbanned users (both client and driver must be unbanned) between Oct 1, 2013 and Oct 3, 2013. The cancellation rate is computed by dividing the number of canceled (by client or driver) requests made by unbanned users by the total number of requests made by unbanned users.</p>
<p>For the above tables, your SQL query should return the following rows with the cancellation rate being rounded to two decimal places.</p>
<table>
<thead>
<tr>
<th>Day</th>
<th>Cancellation Rate</th>
</tr>
</thead>
<tbody><tr>
<td>2013-10-01</td>
<td>0.33</td>
</tr>
<tr>
<td>2013-10-02</td>
<td>0.00</td>
</tr>
<tr>
<td>2013-10-03</td>
<td>0.50</td>
</tr>
</tbody></table>
<h1 id="翻譯"><a href="#翻譯" class="headerlink" title="翻譯"></a>翻譯</h1><ul>
<li>Trips 表格紀錄所有計程車的乘車紀錄，每一筆資料 Id 為唯一值, 其中 Client_Id, Driver_Id 為外部鍵，參照 Users 表格的 Users_Id，Status 為列舉型態，表示三種狀態，分別為”完成乘車”、”司機取消載客”、”乘客取消乘車”。</li>
<li>Users 表格紀錄所有使用者，每一筆紀錄 Users_Id 為唯一值，其中 Role 欄位為列舉型態，分別為”司機”、”乘客”、”夥伴”。</li>
<li>請撰寫一段 SQL 查詢，找出 2013 年 10 月 1 日至 2013 年 10 月 3 日三日的當日乘車取消率，計算公式如下。</li>
<li>當日由”司機取消載客”、”乘客取消乘車”乘車紀錄次數 / 當日乘車紀錄總次數，且司機與乘客不得為禁用狀態。</li>
</ul>
<h1 id="解題思維"><a href="#解題思維" class="headerlink" title="解題思維"></a>解題思維</h1><blockquote>
<p>TRIPS 以 JOIN 方式關聯 Users 兩次，條件分別為乘客、司機非禁用狀態，時間篩選在 2013 年 10 月 1 日至 2013 年 10 月 3 日三日<br>再 COUNT, SUM 函數分別對第一步驟的結果計算出乘車紀錄總次數、取消乘車紀錄次數<br>最後使用 GROUP BY 方式，就可以得出三日當日的乘車取消率</p>
</blockquote>
<h1 id="解題報告"><a href="#解題報告" class="headerlink" title="解題報告"></a>解題報告</h1><blockquote>
<p>Level: Hard<br>Runtime: 796 ms, faster than 82.29% of Oracle online submissions for Trips and Users.<br>Memory Usage: 0B, less than 100.00% of Oracle online submissions for Trips and Users.</p>
</blockquote>
<h1 id="程式完整解題"><a href="#程式完整解題" class="headerlink" title="程式完整解題"></a>程式完整解題</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Write your PL/SQL query statement below */</span></span><br><span class="line"><span class="keyword">WITH</span> TAXI <span class="keyword">AS</span>(<span class="keyword">SELECT</span>  TRIPS.STATUS       <span class="keyword">AS</span> STATUS</span><br><span class="line">                    ,TRIPS.REQUEST_AT   <span class="keyword">AS</span> REQUESTED_DATE</span><br><span class="line">               <span class="keyword">FROM</span> TRIPS</span><br><span class="line">               <span class="keyword">JOIN</span> Users CLIENTS</span><br><span class="line">                 <span class="keyword">ON</span> (CLIENTS.Users_Id <span class="operator">=</span> TRIPS.CLIENT_ID)</span><br><span class="line">                <span class="keyword">AND</span> CLIENTS.BANNED <span class="operator">=</span> <span class="string">&#x27;No&#x27;</span></span><br><span class="line">               <span class="keyword">JOIN</span> Users DRIVERS</span><br><span class="line">                 <span class="keyword">ON</span> (DRIVERS.Users_Id <span class="operator">=</span> TRIPS.CLIENT_ID)</span><br><span class="line">                <span class="keyword">AND</span> DRIVERS.BANNED <span class="operator">=</span> <span class="string">&#x27;No&#x27;</span></span><br><span class="line">              <span class="keyword">WHERE</span> TO_DATE(TRIPS.REQUEST_AT, <span class="string">&#x27;YYYY-MM-DD&#x27;</span>) <span class="keyword">BETWEEN</span> TO_DATE(<span class="string">&#x27;2013-10-01&#x27;</span>, <span class="string">&#x27;YYYY-MM-DD&#x27;</span>) <span class="keyword">AND</span> TO_DATE(<span class="string">&#x27;2013-10-03&#x27;</span>, <span class="string">&#x27;YYYY-MM-DD&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> TOTAL_REQ.REQ_DATE                                    <span class="keyword">AS</span> &quot;Day&quot;</span><br><span class="line">      ,ROUND(CANCELLEDL_REQ.TIMES <span class="operator">*</span><span class="number">1.0</span><span class="operator">/</span> TOTAL_REQ.TIMES, <span class="number">2</span>)  <span class="keyword">AS</span> &quot;Cancellation Rate&quot;</span><br><span class="line">  <span class="keyword">FROM</span>  (<span class="keyword">SELECT</span> REQUESTED_DATE <span class="keyword">AS</span> REQ_DATE</span><br><span class="line">               ,<span class="built_in">COUNT</span>(<span class="operator">*</span>)       <span class="keyword">AS</span> TIMES</span><br><span class="line">          <span class="keyword">FROM</span> TAXI</span><br><span class="line">          <span class="keyword">GROUP</span> <span class="keyword">BY</span> REQUESTED_DATE) TOTAL_REQ</span><br><span class="line">  <span class="keyword">JOIN</span>(<span class="keyword">SELECT</span> REQUESTED_DATE  <span class="keyword">AS</span> REQ_DATE</span><br><span class="line">             ,<span class="built_in">SUM</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> (STATUS <span class="operator">=</span> <span class="string">&#x27;cancelled_by_client&#x27;</span> <span class="keyword">OR</span> STATUS <span class="operator">=</span> <span class="string">&#x27;cancelled_by_driver&#x27;</span>) <span class="keyword">THEN</span> <span class="number">1</span></span><br><span class="line">                           <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)      <span class="keyword">AS</span> TIMES</span><br><span class="line">         <span class="keyword">FROM</span> TAXI</span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span> REQUESTED_DATE) CANCELLEDL_REQ</span><br><span class="line">    <span class="keyword">ON</span> TOTAL_REQ.REQ_DATE <span class="operator">=</span> CANCELLEDL_REQ.REQ_DATE</span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> TOTAL_REQ.REQ_DATE</span><br></pre></td></tr></table></figure>

<h2 id="SQL-Schema"><a href="#SQL-Schema" class="headerlink" title="SQL Schema"></a>SQL Schema</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> If <span class="keyword">Not</span> <span class="keyword">Exists</span> Trips (Id <span class="type">int</span>, Client_Id <span class="type">int</span>, Driver_Id <span class="type">int</span>, City_Id <span class="type">int</span>, Status ENUM(<span class="string">&#x27;completed&#x27;</span>, <span class="string">&#x27;cancelled_by_driver&#x27;</span>, <span class="string">&#x27;cancelled_by_client&#x27;</span>), Request_at <span class="type">varchar</span>(<span class="number">50</span>))</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> If <span class="keyword">Not</span> <span class="keyword">Exists</span> Users (Users_Id <span class="type">int</span>, Banned <span class="type">varchar</span>(<span class="number">50</span>), Role ENUM(<span class="string">&#x27;client&#x27;</span>, <span class="string">&#x27;driver&#x27;</span>, <span class="string">&#x27;partner&#x27;</span>))</span><br><span class="line"><span class="keyword">Truncate</span> <span class="keyword">table</span> Trips</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Trips (Id, Client_Id, Driver_Id, City_Id, Status, Request_at) <span class="keyword">values</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;10&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;completed&#x27;</span>, <span class="string">&#x27;2013-10-01&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Trips (Id, Client_Id, Driver_Id, City_Id, Status, Request_at) <span class="keyword">values</span> (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;11&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;cancelled_by_driver&#x27;</span>, <span class="string">&#x27;2013-10-01&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Trips (Id, Client_Id, Driver_Id, City_Id, Status, Request_at) <span class="keyword">values</span> (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;12&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;completed&#x27;</span>, <span class="string">&#x27;2013-10-01&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Trips (Id, Client_Id, Driver_Id, City_Id, Status, Request_at) <span class="keyword">values</span> (<span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;13&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;cancelled_by_client&#x27;</span>, <span class="string">&#x27;2013-10-01&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Trips (Id, Client_Id, Driver_Id, City_Id, Status, Request_at) <span class="keyword">values</span> (<span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;10&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;completed&#x27;</span>, <span class="string">&#x27;2013-10-02&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Trips (Id, Client_Id, Driver_Id, City_Id, Status, Request_at) <span class="keyword">values</span> (<span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;11&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;completed&#x27;</span>, <span class="string">&#x27;2013-10-02&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Trips (Id, Client_Id, Driver_Id, City_Id, Status, Request_at) <span class="keyword">values</span> (<span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;12&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;completed&#x27;</span>, <span class="string">&#x27;2013-10-02&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Trips (Id, Client_Id, Driver_Id, City_Id, Status, Request_at) <span class="keyword">values</span> (<span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;12&#x27;</span>, <span class="string">&#x27;12&#x27;</span>, <span class="string">&#x27;completed&#x27;</span>, <span class="string">&#x27;2013-10-03&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Trips (Id, Client_Id, Driver_Id, City_Id, Status, Request_at) <span class="keyword">values</span> (<span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;10&#x27;</span>, <span class="string">&#x27;12&#x27;</span>, <span class="string">&#x27;completed&#x27;</span>, <span class="string">&#x27;2013-10-03&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Trips (Id, Client_Id, Driver_Id, City_Id, Status, Request_at) <span class="keyword">values</span> (<span class="string">&#x27;10&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;13&#x27;</span>, <span class="string">&#x27;12&#x27;</span>, <span class="string">&#x27;cancelled_by_driver&#x27;</span>, <span class="string">&#x27;2013-10-03&#x27;</span>)</span><br><span class="line"><span class="keyword">Truncate</span> <span class="keyword">table</span> Users</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Users (Users_Id, Banned, Role) <span class="keyword">values</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;No&#x27;</span>, <span class="string">&#x27;client&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Users (Users_Id, Banned, Role) <span class="keyword">values</span> (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;Yes&#x27;</span>, <span class="string">&#x27;client&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Users (Users_Id, Banned, Role) <span class="keyword">values</span> (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;No&#x27;</span>, <span class="string">&#x27;client&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Users (Users_Id, Banned, Role) <span class="keyword">values</span> (<span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;No&#x27;</span>, <span class="string">&#x27;client&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Users (Users_Id, Banned, Role) <span class="keyword">values</span> (<span class="string">&#x27;10&#x27;</span>, <span class="string">&#x27;No&#x27;</span>, <span class="string">&#x27;driver&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Users (Users_Id, Banned, Role) <span class="keyword">values</span> (<span class="string">&#x27;11&#x27;</span>, <span class="string">&#x27;No&#x27;</span>, <span class="string">&#x27;driver&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Users (Users_Id, Banned, Role) <span class="keyword">values</span> (<span class="string">&#x27;12&#x27;</span>, <span class="string">&#x27;No&#x27;</span>, <span class="string">&#x27;driver&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Users (Users_Id, Banned, Role) <span class="keyword">values</span> (<span class="string">&#x27;13&#x27;</span>, <span class="string">&#x27;No&#x27;</span>, <span class="string">&#x27;driver&#x27;</span>)</span><br></pre></td></tr></table></figure>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2020/07/01/%5BLeetCode%5D%20180.%20Consecutive%20Numbers/"><img class="fill" src="https://images.unsplash.com/photo-1535637965215-a739b226b228?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=1350&amp;q=80" alt="[LeetCode]180. Consecutive Numbers"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-06-30T17:34:38.000Z" title="7/1/2020, 1:34:38 AM">2020-07-01</time>發表</span><span class="level-item"><time dateTime="2021-06-27T15:41:33.017Z" title="6/27/2021, 11:41:33 PM">2021-06-27</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/LeetCode/">LeetCode</a></span><span class="level-item">2 分鐘讀完 (大約257個字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/07/01/%5BLeetCode%5D%20180.%20Consecutive%20Numbers/">[LeetCode]180. Consecutive Numbers</a></h1><div class="content"><h1 id="問題描述"><a href="#問題描述" class="headerlink" title="問題描述"></a>問題描述</h1><blockquote>
<p>Write a SQL query to find all numbers that appear at least three times consecutively.</p>
</blockquote>
<table>
<thead>
<tr>
<th>Id</th>
<th>Num</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>1</td>
</tr>
<tr>
<td>4</td>
<td>2</td>
</tr>
<tr>
<td>5</td>
<td>1</td>
</tr>
<tr>
<td>6</td>
<td>2</td>
</tr>
<tr>
<td>7</td>
<td>2</td>
</tr>
</tbody></table>
<blockquote>
<p>For example, given the above Logs table, 1 is the only number that appears consecutively for at least three times.</p>
</blockquote>
<table>
<thead>
<tr>
<th>ConsecutiveNums</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
</tr>
</tbody></table>
<h1 id="翻譯"><a href="#翻譯" class="headerlink" title="翻譯"></a>翻譯</h1><blockquote>
<p>請寫出一段 SQL 查詢能找出所有連續出現三次以上的數字</p>
</blockquote>
<h1 id="解題思維"><a href="#解題思維" class="headerlink" title="解題思維"></a>解題思維</h1><blockquote>
<p>利用 LEAD(), LAG() Oracle 分析函數可分別得出該數字的上下數字，再判斷上下數字、與該數字都是否相等，即為答案。</p>
</blockquote>
<h1 id="解題報告"><a href="#解題報告" class="headerlink" title="解題報告"></a>解題報告</h1><blockquote>
<p>Level: Medium<br>Runtime: 678 ms, faster than 98.93% of Oracle online submissions for Consecutive Numbers.<br>Memory Usage: 0B, less than 100.00% of Oracle online submissions for Consecutive Numbers.</p>
</blockquote>
<h1 id="程式完整解題"><a href="#程式完整解題" class="headerlink" title="程式完整解題"></a>程式完整解題</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Write your PL/SQL query statement below */</span></span><br><span class="line"><span class="keyword">SELECT</span> NUM <span class="keyword">AS</span> ConsecutiveNums</span><br><span class="line">  <span class="keyword">FROM</span>(<span class="keyword">SELECT</span> NUM</span><br><span class="line">             ,<span class="built_in">LEAD</span>(NUM) <span class="keyword">OVER</span> (<span class="keyword">ORDER</span> <span class="keyword">BY</span> ID) <span class="keyword">AS</span> NEXT_NUM</span><br><span class="line">             ,<span class="built_in">LAG</span>(NUM)  <span class="keyword">OVER</span> (<span class="keyword">ORDER</span> <span class="keyword">BY</span> ID) <span class="keyword">AS</span> LAST_NUM</span><br><span class="line">         <span class="keyword">FROM</span> Logs)</span><br><span class="line"> <span class="keyword">WHERE</span> NEXT_NUM <span class="operator">=</span> LAST_NUM</span><br><span class="line">   <span class="keyword">AND</span> NEXT_NUM <span class="operator">=</span> NUM</span><br><span class="line"> <span class="keyword">GROUP</span> <span class="keyword">BY</span> NUM;</span><br></pre></td></tr></table></figure>

<h2 id="SQL-Schema"><a href="#SQL-Schema" class="headerlink" title="SQL Schema"></a>SQL Schema</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> If <span class="keyword">Not</span> <span class="keyword">Exists</span> Logs (Id <span class="type">int</span>, Num <span class="type">int</span>)</span><br><span class="line"><span class="keyword">Truncate</span> <span class="keyword">table</span> Logs</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Logs (Id, Num) <span class="keyword">values</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Logs (Id, Num) <span class="keyword">values</span> (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Logs (Id, Num) <span class="keyword">values</span> (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Logs (Id, Num) <span class="keyword">values</span> (<span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Logs (Id, Num) <span class="keyword">values</span> (<span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Logs (Id, Num) <span class="keyword">values</span> (<span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Logs (Id, Num) <span class="keyword">values</span> (<span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br></pre></td></tr></table></figure>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous is-invisible is-hidden-mobile"><a href="/page/0/">上一頁</a></div><div class="pagination-next"><a href="/page/2/">下一頁</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link is-current" href="/">1</a></li><li><a class="pagination-link" href="/page/2/">2</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/profile.jpg" alt="Gordon Fang"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Gordon Fang</p><p class="is-size-6 is-block">Application System Engineer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Taiwan</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">20</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分類</p><a href="/categories"><p class="title">8</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">標籤</p><a href="/tags"><p class="title">21</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/gordonfang199649" target="_blank" rel="noopener">追蹤</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/gordonfang199649"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://www.facebook.com/misfgl/"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Linkedin" href="https://www.linkedin.com/in/gordon-fang-aaa226154/"><i class="fab fa-linkedin"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分類</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Azure-DevOps/"><span class="level-start"><span class="level-item">Azure DevOps</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Heroku/"><span class="level-start"><span class="level-item">Heroku</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Hexo/"><span class="level-start"><span class="level-item">Hexo</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Image-Processing/"><span class="level-start"><span class="level-item">Image Processing</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Java/"><span class="level-start"><span class="level-item">Java</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/LeetCode/"><span class="level-start"><span class="level-item">LeetCode</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/Oracle-SQL/"><span class="level-start"><span class="level-item">Oracle SQL</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Spring-Boot/"><span class="level-start"><span class="level-item">Spring Boot</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-03-30T16:35:12.000Z">2022-03-31</time></p><p class="title"><a href="/2022/03/31/Azure-DevOps-Stakeholder-%E6%AC%8A%E9%99%90%E7%9C%8B%E4%B8%8D%E5%88%B0-Repo/">Azure DevOps Stakeholder 權限看不到 Repo</a></p><p class="categories"><a href="/categories/Azure-DevOps/">Azure DevOps</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-03-12T09:22:50.000Z">2022-03-12</time></p><p class="title"><a href="/2022/03/12/%E5%A6%82%E4%BD%95%E5%9C%A8-Hexo-%E9%96%8B%E7%99%BC%E7%92%B0%E5%A2%83%E7%9A%84%E6%96%87%E7%AB%A0%E4%B8%AD%E5%8A%A0%E5%85%A5-LikeCoin-button/">[Hexo] 如何在 Hexo 開發環境的文章中加入 LikeCoin button</a></p><p class="categories"><a href="/categories/Hexo/">Hexo</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-03-12T06:20:20.000Z">2022-03-12</time></p><p class="title"><a href="/2022/03/12/Heroku-Couldn-t-find-that-process-type-web/">[Heroku][Flask] Couldn&#039;t find that process type (web).</a></p><p class="categories"><a href="/categories/Heroku/">Heroku</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-03-07T16:45:09.000Z">2022-03-08</time></p><p class="title"><a href="/2022/03/08/BigDecimal-%E7%B2%BE%E5%BA%A6%E8%A8%88%E7%AE%97/">[Java] BigDecimal 精度計算</a></p><p class="categories"><a href="/categories/Java/">Java</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-03-06T16:35:13.000Z">2022-03-07</time></p><p class="title"><a href="/2022/03/07/%5BSpring%5D%20Set%20exposeProxy%20property%20on%20Advised%20to%20true/">[Spring] Set exposeProxy property on Advised to true</a></p><p class="categories"><a href="/categories/Spring-Boot/">Spring Boot</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">彙整</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">三月 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">二月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">六月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/07/"><span class="level-start"><span class="level-item">七月 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/06/"><span class="level-start"><span class="level-item">六月 2020</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">五月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/01/"><span class="level-start"><span class="level-item">一月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">標籤</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Array/"><span class="tag">Array</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Azure-DevOps/"><span class="tag">Azure DevOps</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BlockChain/"><span class="tag">BlockChain</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Blog/"><span class="tag">Blog</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C++</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Flask/"><span class="tag">Flask</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Git/"><span class="tag">Git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GitHub/"><span class="tag">GitHub</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Heroku/"><span class="tag">Heroku</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hexo/"><span class="tag">Hexo</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Image-Processing/"><span class="tag">Image Processing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Java/"><span class="tag">Java</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LikeCoin/"><span class="tag">LikeCoin</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LinkedList/"><span class="tag">LinkedList</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Number/"><span class="tag">Number</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PL-SQL/"><span class="tag">PL/SQL</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Queue/"><span class="tag">Queue</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Spring-Boot/"><span class="tag">Spring Boot</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Tree/"><span class="tag">Tree</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BF%83%E5%BE%97/"><span class="tag">心得</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">訂閱 Email</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="訂閱"></div></div></form></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Gordon的寇汀筆記本" height="28"></a><p class="is-size-7"><span>&copy; 2022 Gordon Fang</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-TW");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到頁首" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此網站使用Cookie來改善您的體驗。",
          dismiss: "知道了！",
          allow: "允許使用Cookie",
          deny: "拒絕",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="請輸入關鍵字..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"請輸入關鍵字...","untitled":"(無標題)","posts":"文章","pages":"頁面","categories":"分類","tags":"標籤"});
        });</script></body></html>